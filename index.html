<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> 
  <link rel="stylesheet" href="style.css" />
    <title>Work Day Scheduler</title>
  </head>

  
  <body>
    <header class="jumbotron">
      <h1 class="display-3">Work Day Scheduler</h1>
      <p class="lead">A simple calendar app for scheduling your work day</p>
      <p id="currentDay" class="lead"></p>
    </header>
    <div class="container">
    
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="library/moment.min.js"></script>

    <script type="text/javascript">
      $(document).ready(function() {

//Listing today's date in header
  var nowHead = moment().format('MMMM Do, YYYY');
  $("#currentDay").text(nowHead);
    
//Creating calendar hours
var hourArr = [
//  {hour: "8 AM", military: 8},
//  {hour: "9 AM", military: 9},
//  {hour: "10 AM", military: 10},
 {hour: "11 AM", military: 11,},
 {hour: "12 PM", military: 12},
 {hour: "1 PM", military: 13},
 {hour: "2 PM", military: 14},
 {hour: "3 PM", military: 15},
//  {hour: "4 PM", military: 16},
//  {hour: "5 PM", military: 17},
//  {hour: "6 PM", military: 18},
];  

// Create day view of calendar & for-loop to iterate through the time array.

function renderCal() {
  for (var i = 0; i < hourArr.length; i++) {  
    var row = $("<div>");
    row.addClass("row row1 time-block");
    row.attr("time-hour", hourArr[i].hour)
    row.attr("id", hourArr[i].military);
    $(".container").append(row);

    var hourCol = $("<div>");
    hourCol.addClass("col col-2 justify-content-center hour row time-block ml-2 py-4");
    hourCol.text($(row).attr("time-hour"));
    $(row).append(hourCol);

    var inputCol = $("<input>");
    inputCol.addClass("col col-8 input row time-block ml-3");
    inputCol.attr("input-key", hourArr[i].military);
    $(row).append(inputCol);

    var saveCol = $("<div>");
    saveCol.addClass("col col-2 justify-content-center hour save row time-block ml-3");
    $(row).append(saveCol);

    localStorage.setItem("hourArr", JSON.stringify(hourArr));

}}

renderCal();

function renderSaveBtn() {
  var saveBtn = $("<button>");
    saveBtn.addClass("btn saveBtn btn-primary my-2 mx-2");
    saveBtn.text("Save");
    $(".save").append(saveBtn);
}

renderSaveBtn();

//Change <input> background color based on time/////////////////////////////////
var pastPresentFuture = function () {
  var currentTime = (moment().format('H'));

  for (var i = 0; i < hourArr.length; i++) {
  var militaryID = hourArr[i].military;
  
  //Ensuring both var are num
  militaryNum = parseInt(militaryID);
  timeNum = parseInt(currentTime);
  
  if (militaryNum < timeNum)  {
    $("#" + militaryID).children("input").addClass("past");
  }

  else if (militaryNum === timeNum ) {
    $("#" + militaryID).children("input").addClass("present");
  }

  else {
    $("#" + militaryID).children("input").addClass("future");
  }
};
  
  };

pastPresentFuture();

//input, saveBtn, localStorage //////////////////////////////////////////////////////
var apptArr = [];

function init () {
  var storedAppt = JSON.parse(localStorage.getItem("apptArr"));
  if (storedAppt !== null) {
    storedAppt = apptArr;
  }
  render();
}

function render () {
$(".input").each(function() {
  var currentInput = $(this).attr("input-key");
  var currentText = $(this).text();

//PSUEDO CODE ///
//Take apptArr.apptHour.value and find the ID that matches.
//Display value of the appointment key from 
//apptArr in child of the parent row w matching ID

})
}

init();

$(".saveBtn").on("click", function() {
  var apptHour = $(this).parent().parent().attr("id");
  var apptInput = $(this).parent().siblings(".input").val();

    var inputArr = {
    apptHr: apptHour,
    appt: apptInput
  }

    apptArr.push(inputArr);
    console.log(apptArr);
    storeAppt();
  });

function storeAppt() {
  localStorage.setItem("apptArr", JSON.stringify(apptArr));
}
//localStorage//////////////////////////////////////////////////////

  //////////////////////////////////////////
      });
    
</script>
  </body>
</html>